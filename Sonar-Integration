
ðŸš€ SonarQube Integration â€“ Stepâ€‘byâ€‘Step Guide
This section helps you integrate SonarQube Code Analysis into your Jenkins Pipeline as taught in the lecture.


ðŸ”§ Step 1 â€” Install & Configure SonarQube Scanner in Jenkins
âœ… 1. Add the SonarQube Scanner Tool

Go to Manage Jenkins â†’ Tools
Scroll to SonarQube Scanner Installation
Click Add SonarQube Scanner
Choose version: SonarQube Scanner 6.2.14610
Name it exactly: sonar6.2
Save


âœ… 2. Add SonarQube Server Details

Go to Manage Jenkins â†’ System
Scroll to SonarQube Servers
Check Environment variables
Click Add SonarQube
Name: SonarServer
URL format:
http://<SONAR_PRIVATE_IP>:80




Generate a User Token from SonarQube:Click profile â†’ My Account â†’ Security â†’ Generate Token
Store token in Jenkins as Secret Text credential
Select this token under the Sonar server settings
Save
âœ” Ensure SonarQube SG allows port 80 from Jenkins SG.


ðŸ§ª Step 2 â€” Add Checkstyle Analysis Stage
Before Sonar, we run Checkstyle using Maven.
stage('Checkstyle Analysis') {
    steps {
        sh 'mvn checkstyle:checkstyle'
    }
}



This produces checkstyle-result.xml inside target/.


ðŸ›° Step 3 â€” Add SonarQube Code Analysis Stage
Full Stage:
stage('Sonar Code Analysis') {
    environment {
        scannerHome = tool 'sonar6.2'
    }
    steps {
        sh """
        ${scannerHome}/bin/sonar-scanner \
        -Dsonar.projectKey=vprofile \
        -Dsonar.projectName=vprofile \
        -Dsonar.projectVersion=1.0 \
        -Dsonar.sources=./src \
        -Dsonar.junit.reportsPath=target/surefire-reports \
        -Dsonar.jacoco.reportsPath=target/jacoco.exec \
        -Dsonar.checkstyle.reportPaths=target/checkstyle-result.xml
        """
    }
}





ðŸš¦ Step 4 â€” Configure Quality Gates in SonarQube
1. Create Custom Quality Gate

Go to SonarQube â†’ Quality Gates â†’ Create
Name: vprofile-QG
Click Unlock editing
Add Condition:Metric: Bugs
Operator: >
Value: 10
2. Assign Quality Gate to Project

Open project: vprofile
Go to Project Settings â†’ Quality Gate
Select: vprofile-QG


ðŸ”— Step 5 â€” Create Webhook for Quality Gate Result
SonarQube must notify Jenkins.
Create Webhook:

Go to Project â†’ Project Settings â†’ Webhooks
Name: Jenkins-ci-webhook
URL format:
http://<JENKINS_PRIVATE_IP>:8080/sonarqube-webhook



âœ” Ensure Jenkins SG allows port 8080 from SonarQube SG.


ðŸ§© Step 6 â€” Add Quality Gate Check Stage
stage('Quality Gate') {
    steps {
        timeout(time: 1, unit: 'MINUTES') {
            waitForQualityGate abortPipeline: true
        }
    }
}





ðŸ“š Useful References

Jenkins Pipeline Syntax Docs: https://www.jenkins.io/doc/book/pipeline/
SonarQube Scanner for Jenkins Docs
SonarQube Webhooks Guide
Jenkins Pipeline Syntax Docs: https://www.jenkins.io/doc/book/pipeline/
Git Plugin Pipeline Examples
Maven Pipeline Docs

